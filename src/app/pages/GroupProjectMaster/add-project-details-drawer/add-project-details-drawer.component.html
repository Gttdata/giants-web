<div class="header">
    <button type="button" nz-button (click)="close(myForm)" class="ant-btn">
        <i nz-icon nzType="close" nzTheme="outline"></i>
    </button>
</div>

<form nz-form #myForm="ngForm">
    <nz-spin [nzSpinning]="isSpinning">
        <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24">
            <div class="my-box">
                <div nz-row>
                    <div nz-col nzXs="24" nzSm="24" nzMd="6" nzLg="6" nzXl="6">
                        <nz-form-item>
                            <nz-form-label nzRequired nzNoColon>Date</nz-form-label>

                            <nz-form-control>
                                <nz-date-picker name="date" nzFormat="dd/MM/yyyy" [(ngModel)]="data.DATE_OF_PROJECT">
                                </nz-date-picker>
                            </nz-form-control>
                        </nz-form-item>
                    </div>

                    <div nz-col nzXs="24" nzSm="24" nzMd="18" nzLg="18" nzXl="18">
                        <nz-form-item>
                            <nz-form-label nzRequired nzNoColon>Project Name</nz-form-label>

                            <nz-form-control nzHasFeedback nzErrorTip="Please Enter Valid Project Name">
                                <input nz-input name="name" autocomplete="off" placeholder="Enter Project Name"
                                    maxlength="200" [(ngModel)]="data.PROJECT_NAME" required />
                            </nz-form-control>

                            <span *ngIf="data.PROJECT_NAME" style="font-size: 10px; color: red;">
                                {{data.PROJECT_NAME.length}}/ 200
                            </span>
                        </nz-form-item>
                    </div>
                </div>

                <div nz-row>
                    <div nz-col nzXs="24" nzSm="24" nzMd="16" nzLg="16" nzXl="16">
                        <nz-form-item>
                            <nz-form-label nzRequired nzNoColon>
                                Project Type

                                <!-- &nbsp;
                                <span nz-icon nzType="plus-circle" nzTheme="twotone"
                                    style="font-size: 20px; cursor: pointer;" (click)="addProjectType()">
                                </span> -->
                            </nz-form-label>

                            <nz-form-control nzHasFeedback nzErrorTip="Please Select Project Type">
                                <nz-select name="projectType" nzShowSearch nzAllowClear style="width: 100%"
                                    nzPlaceHolder="Select Project Type" [(ngModel)]="data.PROJECT_TYPE_ID" required>

                                    <nz-option *ngFor="let project of projects;" [nzValue]="project.ID"
                                        [nzLabel]="project.NAME">
                                    </nz-option>
                                </nz-select>
                            </nz-form-control>
                        </nz-form-item>
                    </div>

                    <div nz-col nzXs="24" nzSm="24" nzMd="8" nzLg="8" nzXl="8">
                        <nz-form-item>
                            <nz-form-label nzNoColon>Total Expenses (In Rupees)</nz-form-label>

                            <nz-form-control nzErrorTip="Please Enter Expenses Amount">
                                <nz-input-group nzAddOnAfter="₹">
                                    <input style="text-align: right;" autoComplete="off" nz-input name="expensesamount"
                                        (keypress)="numberOnly($event)" (paste)="$event.preventDefault()"
                                        [(ngModel)]="data.TOTAL_EXPENSES" placeHolder="Amount in Rs." maxlength="16" />
                                </nz-input-group>
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                </div>

                <div nz-row>
                    <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24">
                        <nz-form-item>
                            <nz-form-label nzNoColon>Project Description</nz-form-label>

                            <nz-form-control nzErrorTip="Please Enter Description">
                                <angular-editor name="description" [placeholder]="'Enter Project Description'"
                                    [config]="editorConfig" [(ngModel)]="data.DESCRIPTION">
                                </angular-editor>
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                </div>

                <div nz-row>
                    <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24">
                        <nz-form-item>
                            <nz-form-label nzNoColon>Award Received</nz-form-label>

                            <nz-form-control>
                                <nz-select name="hashTag" nzShowSearch nzAllowClear nzMode="tags" [nzMaxTagCount]="5"
                                    style="width: 100%" nzPlaceHolder="Award(s)" [(ngModel)]="data.AWARDS_RECEIVED">
                                </nz-select>
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                </div>

                <div nz-row>
                    <div nz-col nzSpan="24">
                        <nz-form-item>
                            <nz-form-label nzNoColon>Beneficiary Details</nz-form-label>

                            <nz-form-control nzErrorTip="Please Enter Beneficiary Details">
                                <angular-editor name="benificierydetails" [placeholder]="'Enter Beneficiary Details'"
                                    [config]="editorConfig" [(ngModel)]="data.BENIFICIERY_DETAILS">
                                </angular-editor>
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                </div>

                <div nz-row>
                    <div nz-col nzSpan="12">
                        <nz-form-item>
                            <nz-form-label nzRequired nzNoColon>Current Status</nz-form-label>

                            <nz-form-control nzHasFeedback nzErrorTip="Please Select Current Status">
                                <nz-select name="currentstatus" nzShowSearch nzAllowClear style="width: 100%"
                                    nzPlaceHolder="Select Current Status" [(ngModel)]="data.CURRENT_STATUS" required>
                                    <nz-option nzValue="P" nzLabel="Upcoming"></nz-option>
                                    <nz-option nzValue="S" nzLabel="In Progress"></nz-option>
                                    <nz-option nzValue="H" nzLabel="On Hold"></nz-option>
                                    <nz-option nzValue="C" nzLabel="Completed"></nz-option>
                                </nz-select>
                            </nz-form-control>
                        </nz-form-item>
                    </div>
                </div>
            </div>
        </div>

        <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24">
            <div class="my-box">
                <div nz-row>
                    <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24">
                        <div nz-row>
                            <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24" style="text-align: center;">
                                <nz-form-item>
                                    <nz-form-label nzNoColon>
                                        Photo 1 &nbsp;
                                        <span *ngIf="data.PHOTO1">
                                            <i nz-icon style="margin-top: 3px;" nzType="delete" nzTheme="twotone"
                                                [nzTwotoneColor]="'#ff0000'" nz-popconfirm
                                                nzPopconfirmTitle="Are you sure delete this Image?"
                                                (nzOnConfirm)="clear1()" (nzOnCancel)="cancel()"
                                                nzPopconfirmPlacement="top">
                                            </i>
                                        </span>
                                    </nz-form-label>

                                    <nz-form-control>
                                        <button nz-button style="height: 28px; padding: 0px 7px; font-size: 12px;"
                                            (click)="fileInput1.click()">Choose File

                                            <input #fileInput1 type="file" accept="image/*"
                                                (change)="onFileSelected1($event)" (click)="fileInput1.value = null"
                                                style="display: none;" />
                                        </button>
                                    </nz-form-control>
                                </nz-form-item>
                            </div>

                            <span *ngIf="data.PHOTO1">
                                <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24"
                                    style="text-align: center;">
                                    <nz-form-item>
                                        <div>
                                            <img [src]="data.PHOTO1" (click)="viewImage(data.PHOTO1)"
                                                style="height: 120px; width: 160px;border: 2px solid gray; border-radius: 5px; cursor: pointer;">
                                        </div>
                                    </nz-form-item>
                                </div>
                            </span>
                        </div>
                    </div>
                </div>

                <div nz-row>
                    <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24">
                        <div nz-row>
                            <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24" style="text-align: center;">
                                <nz-form-item>
                                    <nz-form-label nzNoColon>
                                        Photo 2 &nbsp;
                                        <span *ngIf="data.PHOTO2">
                                            <i nz-icon style="margin-top: 3px;" nzType="delete" nzTheme="twotone"
                                                [nzTwotoneColor]="'#ff0000'" nz-popconfirm
                                                nzPopconfirmTitle="Are you sure delete this Image?"
                                                (nzOnConfirm)="clear2()" (nzOnCancel)="cancel()"
                                                nzPopconfirmPlacement="top">
                                            </i>
                                        </span>
                                    </nz-form-label>

                                    <nz-form-control>
                                        <button nz-button style="height: 28px; padding: 0px 7px; font-size: 12px;"
                                            (click)="fileInput2.click()">Choose File

                                            <input #fileInput2 type="file" accept="image/*"
                                                (change)="onFileSelected2($event)" (click)="fileInput2.value = null"
                                                style="display: none;" />
                                        </button>
                                    </nz-form-control>
                                </nz-form-item>
                            </div>

                            <span *ngIf="data.PHOTO2">
                                <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24"
                                    style="text-align: center;">
                                    <nz-form-item>
                                        <div>
                                            <img [src]="data.PHOTO2" (click)="viewImage(data.PHOTO2)"
                                                style="height: 120px; width: 160px; border: 2px solid gray; border-radius: 5px; cursor: pointer;">
                                        </div>
                                    </nz-form-item>
                                </div>
                            </span>
                        </div>
                    </div>
                </div>

                <div nz-row>
                    <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24">
                        <div nz-row>
                            <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24" style="text-align: center;">
                                <nz-form-item>
                                    <nz-form-label nzNoColon>
                                        Photo 3 &nbsp;
                                        <span *ngIf="data.PHOTO3">
                                            <i nz-icon style="margin-top: 3px;" nzType="delete" nzTheme="twotone"
                                                [nzTwotoneColor]="'#ff0000'" nz-popconfirm
                                                nzPopconfirmTitle="Are you sure delete this Image?"
                                                (nzOnConfirm)="clear3()" (nzOnCancel)="cancel()"
                                                nzPopconfirmPlacement="top">
                                            </i>
                                        </span>
                                    </nz-form-label>

                                    <nz-form-control>
                                        <button nz-button style="height: 28px; padding: 0px 7px; font-size: 12px;"
                                            (click)="fileInput3.click()">Choose File

                                            <input #fileInput3 type="file" accept="image/*"
                                                (change)="onFileSelected3($event)" (click)="fileInput3.value = null"
                                                style="display: none;" />
                                        </button>
                                    </nz-form-control>
                                </nz-form-item>
                            </div>

                            <span *ngIf="data.PHOTO3">
                                <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24"
                                    style="text-align: center;">
                                    <nz-form-item>
                                        <div>
                                            <img [src]="data.PHOTO3" (click)="viewImage(data.PHOTO3)"
                                                style="height: 120px; width: 160px; border: 2px solid gray; border-radius: 5px; cursor: pointer;">
                                        </div>
                                    </nz-form-item>
                                </div>
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nz-spin>
</form>

<div class="footer">
    <button type="button" nz-button (click)="close(myForm)" class="ant-btn" style="margin-right: 8px;">
        <span>Cancel</span>
    </button>

    <button type="button" nz-button *ngIf="data.PROJECT_NAME" (click)="previewModalOpen()" class="ant-btn"
        style="margin-right: 8px;" [nzLoading]="isSpinning">
        <span>Preview</span>
    </button>

    <button type="button" *ngIf="data.STATUS == 'D'" class="ant-btn ant-btn-primary" nz-button [nzLoading]="isSpinning"
        (click)="save(false,myForm,'D')" style="margin-right: 8px;">
        <span>Save as Draft</span>
    </button>

    <button type="button" class="ant-btn ant-btn-primary" nz-button [nzLoading]="isSpinning"
        (click)="save(false,myForm,'P')">
        <span>Publish</span>
    </button>
</div>

<nz-drawer [nzBodyStyle]="{ height: 'calc(100% - 55px)', overflow: 'auto', 'padding-bottom': '53px' }"
    [nzClosable]="false" [nzMask]="true" [nzMaskClosable]="false" [nzWidth]="450" [nzVisible]="eventTypeDrawerVisible"
    [nzTitle]="eventTypeDrawerTitle" (nzOnClose)="eventTypeDrawerClose()" (nzKeyboard)="true">

    <app-project-drawer [drawerClose]="eventTypeDrawerCloseCallback" [drawerVisible]="drawerVisible"
        [data]="eventTypeDrawerData">
    </app-project-drawer>
</nz-drawer>

<nz-modal nzWidth="1000px" [nzBodyStyle]="{height : '460px'}" [(nzVisible)]="previewModalVisible" [nzTitle]="'Preview'"
    [nzContent]="previewModalContent" [nzFooter]="previewModalFooter" (nzOnCancel)="previewModalCancel()"
    nzClosable="false">

    <ng-template #previewModalContent>
        <div style="overflow: auto; height: 430px; padding: 5px;">
            <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24">
                <div style="font-size: 14px; color:black; font-weight: bold; text-align: justify;">
                    {{data.PROJECT_NAME}}
                </div>
            </div>

            <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24">
                <div style="font-size: 10px; text-align: left;">
                    {{data.PROJECT_TYPE_NAME}}
                </div>
            </div>

            <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24">
                <div nz-row>
                    <div nz-col nzXs="8" nzSm="8" nzMd="8" nzLg="8" nzXl="8" style="font-size: 10px; text-align: left;">
                        <i nz-icon nzType="calendar" nzTheme="outline" style="color: #FF7A7A;"></i>&nbsp;
                        <span style="color: black;">{{data.DATE_OF_PROJECT | date:'dd MMM yyyy'}}</span>
                    </div>

                    <div nz-col nzXs="8" nzSm="8" nzMd="8" nzLg="8" nzXl="8"
                        style="font-size: 10px; text-align: center;">
                        <span style="color: #FF7A7A;">₹</span>&nbsp;
                        <span style="color: black;">{{data.TOTAL_EXPENSES}}</span>
                    </div>

                    <div nz-col nzXs="8" nzSm="8" nzMd="8" nzLg="8" nzXl="8"
                        style="font-size: 10px; text-align: right;">
                        <span style="color: #FF7A7A;">Status :</span>&nbsp;
                        <span style="color: black;">{{getCompleteStatus(data.CURRENT_STATUS)}}</span>
                    </div>
                </div>
            </div>

            <div nz-row>
                <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24"
                    style="font-size: 12px; text-align: justify; margin-top: 10px;">
                    <div [innerHTML]="data.DESCRIPTION"></div>
                </div>
            </div>

            <div nz-row>
                <div nz-col nzXs="0" nzSm="0" nzMd="24" nzLg="24" nzXl="24">
                    <div style="padding: 3px;" *ngIf="getImageCount(data.PHOTO1,data.PHOTO2,data.PHOTO3) == 3">
                        <div nz-row>
                            <div nz-col nzXs="16" nzSm="16" nzMd="16" nzLg="16" nzXl="16">
                                <div style="text-align: center; height: 50vh; padding: 1px;">
                                    <img [src]="data.PHOTO1" style="width: 100%; height: 100%; object-fit: cover;">
                                </div>
                            </div>

                            <div nz-col nzXs="8" nzSm="8" nzMd="8" nzLg="8" nzXl="8">
                                <div nz-row>
                                    <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24">
                                        <div style="text-align: center; height: 25vh; padding: 1px;">
                                            <img [src]="data.PHOTO2"
                                                style="width: 100%; height: 100%; object-fit: cover;">
                                        </div>
                                    </div>

                                    <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24">
                                        <div style="text-align: center; height: 25vh; padding: 1px;">
                                            <img [src]="data.PHOTO3"
                                                style="width: 100%; height: 100%; object-fit: cover;">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="padding: 3px;" *ngIf="getImageCount(data.PHOTO1,data.PHOTO2,data.PHOTO3) == 2">
                        <div nz-row>
                            <div nz-col nzXs="12" nzSm="12" nzMd="12" nzLg="12" nzXl="12">
                                <div style="text-align: center; height: 50vh; padding: 1px;">
                                    <img [src]="data.PHOTO1" style="width: 100%; height: 100%; object-fit: cover;">
                                </div>
                            </div>

                            <div nz-col nzXs="12" nzSm="12" nzMd="12" nzLg="12" nzXl="12">
                                <div style="text-align: center; height: 50vh; padding: 1px;">
                                    <img [src]="data.PHOTO2" style="width: 100%; height: 100%; object-fit: cover;">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="padding: 3px;" *ngIf="getImageCount(data.PHOTO1,data.PHOTO2,data.PHOTO3) == 1">
                        <div nz-row>
                            <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24">
                                <div style="text-align: center; height: 50vh;">
                                    <img [src]="data.PHOTO1" style="width: 100%; height: 100%; object-fit: contain;">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div nz-col nzXs="24" nzSm="24" nzMd="0" nzLg="0" nzXl="0">
                    <div style="padding: 3px;" *ngIf="getImageCount(data.PHOTO1,data.PHOTO2,data.PHOTO3) == 3">
                        <div nz-row>
                            <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24">
                                <div style="text-align: center; height: 25vh; padding: 1px;">
                                    <img [src]="data.PHOTO1" style="width: 100%; height: 100%; object-fit: cover;">
                                </div>
                            </div>

                            <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24">
                                <div nz-row>
                                    <div nz-col nzXs="12" nzSm="12" nzMd="12" nzLg="12" nzXl="12">
                                        <div style="text-align: center; height: 15vh; padding: 1px;">
                                            <img [src]="data.PHOTO2"
                                                style="width: 100%; height: 100%; object-fit: cover;">
                                        </div>
                                    </div>

                                    <div nz-col nzXs="12" nzSm="12" nzMd="12" nzLg="12" nzXl="12">
                                        <div style="text-align: center; height: 15vh; padding: 1px;">
                                            <img [src]="data.PHOTO3"
                                                style="width: 100%; height: 100%; object-fit: cover;">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="padding: 3px;" *ngIf="getImageCount(data.PHOTO1,data.PHOTO2,data.PHOTO3) == 2">
                        <div nz-row>
                            <div nz-col nzXs="12" nzSm="12" nzMd="12" nzLg="12" nzXl="12">
                                <div style="text-align: center; height: 20vh; padding: 1px;">
                                    <img [src]="data.PHOTO1" style="width: 100%; height: 100%; object-fit: cover;">
                                </div>
                            </div>

                            <div nz-col nzXs="12" nzSm="12" nzMd="12" nzLg="12" nzXl="12">
                                <div style="text-align: center; height: 20vh; padding: 1px;">
                                    <img [src]="data.PHOTO2" style="width: 100%; height: 100%; object-fit: cover;">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="padding: 3px;" *ngIf="getImageCount(data.PHOTO1,data.PHOTO2,data.PHOTO3) == 1">
                        <div nz-row>
                            <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24">
                                <div style="text-align: center; height: 50vh;">
                                    <img [src]="data.PHOTO1" style="width: 100%; height: 100%; object-fit: contain;">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div nz-row>
                <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24"
                    style="font-size: 12px; text-align: justify; margin-top: 10px;">
                    <div [innerHTML]="data.BENIFICIERY_DETAILS"></div>
                </div>
            </div>

            <div nz-row *ngIf="(data.AWARDS_RECEIVED != null) && (data.AWARDS_RECEIVED != '')">
                <div nz-col nzXs="24" nzSm="24" nzMd="24" nzLg="24" nzXl="24">
                    <div style=" padding: 3px; text-align: justify;">
                        <span *ngFor="let tag of data.AWARDS_RECEIVED;">
                            <span style="color: #1890ff; font-size: 10px;">
                                #{{tag}}
                            </span>
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </ng-template>

    <ng-template #previewModalFooter>
        <button nz-button nzType="default" (click)="previewModalCancel()">
            Cancel
        </button>
    </ng-template>
</nz-modal>